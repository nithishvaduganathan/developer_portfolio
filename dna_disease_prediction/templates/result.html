{% extends "base.html" %}

{% block title %}Prediction Result - DNA Disease Prediction{% endblock %}

{% block content %}
<div class="container my-5">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-lg-12 text-center">
            <h2 class="display-5">
                <i class="bi bi-clipboard-check text-success"></i> 
                Prediction Results
            </h2>
        </div>
    </div>

    <!-- Main Result Card -->
    <div class="row justify-content-center mb-4">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0">
                <div class="card-header text-white" 
                     style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h4 class="mb-0">
                        <i class="bi bi-stethoscope"></i> Disease Prediction
                    </h4>
                </div>
                <div class="card-body">
                    <!-- Predicted Disease -->
                    <div class="text-center mb-4 p-4 bg-light rounded">
                        <h5 class="text-muted mb-2">Predicted Disease:</h5>
                        <h2 class="text-primary mb-3">
                            <strong>{{ result.predicted_disease.replace('_', ' ') }}</strong>
                        </h2>
                        
                        <!-- Confidence Score -->
                        <div class="mb-3">
                            <h6 class="text-muted">Confidence Score:</h6>
                            <div class="progress" style="height: 30px;">
                                <div class="progress-bar 
                                    {% if result.confidence >= 70 %}bg-success
                                    {% elif result.confidence >= 40 %}bg-warning
                                    {% else %}bg-danger{% endif %}" 
                                    role="progressbar" 
                                    style="width: {{ result.confidence }}%;"
                                    aria-valuenow="{{ result.confidence }}" 
                                    aria-valuemin="0" 
                                    aria-valuemax="100">
                                    <strong>{{ result.confidence }}%</strong>
                                </div>
                            </div>
                        </div>

                        <!-- Risk Level Badge -->
                        <div>
                            <h6 class="text-muted">Risk Level:</h6>
                            <span class="badge 
                                {% if result.risk_level == 'High' %}bg-danger
                                {% elif result.risk_level == 'Medium' %}bg-warning text-dark
                                {% else %}bg-success{% endif %}" 
                                style="font-size: 1.2rem; padding: 0.5rem 1.5rem;">
                                {{ result.risk_level }}
                            </span>
                        </div>
                    </div>

                    <!-- Medical Disclaimer -->
                    <div class="alert alert-warning" role="alert">
                        <h6 class="alert-heading">
                            <i class="bi bi-exclamation-triangle-fill"></i> Medical Disclaimer
                        </h6>
                        <p class="mb-0 small">
                            This prediction is generated by a machine learning model for 
                            <strong>educational and research purposes only</strong>. 
                            It should <strong>NOT</strong> be used for medical diagnosis or treatment decisions. 
                            Always consult with qualified healthcare professionals for medical advice.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Disease Probabilities -->
    <div class="row justify-content-center mb-4">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-bar-chart"></i> All Disease Probabilities
                    </h5>
                </div>
                <div class="card-body">
                    {% for disease, probability in result.disease_probabilities.items() %}
                    <div class="mb-3">
                        <div class="d-flex justify-content-between mb-1">
                            <span><strong>{{ disease.replace('_', ' ') }}</strong></span>
                            <span class="text-muted">{{ probability }}%</span>
                        </div>
                        <div class="progress" style="height: 20px;">
                            <div class="progress-bar bg-info" 
                                 role="progressbar" 
                                 style="width: {{ probability }}%;"
                                 aria-valuenow="{{ probability }}" 
                                 aria-valuemin="0" 
                                 aria-valuemax="100">
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- DNA Sequence Statistics -->
    <div class="row justify-content-center mb-4">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-calculator"></i> DNA Sequence Statistics
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="stat-box p-3 bg-light rounded">
                                <h6 class="text-muted mb-2">Sequence Length</h6>
                                <h4 class="text-primary mb-0">
                                    {{ result.statistics.length }} nucleotides
                                </h4>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="stat-box p-3 bg-light rounded">
                                <h6 class="text-muted mb-2">GC Content</h6>
                                <h4 class="text-success mb-0">
                                    {{ result.statistics.gc_content }}%
                                </h4>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-12">
                            <h6 class="text-muted mb-3">Nucleotide Frequencies:</h6>
                            <div class="row">
                                {% for nucleotide, frequency in result.statistics.nucleotide_frequency.items() %}
                                <div class="col-3 text-center mb-2">
                                    <div class="p-2 bg-light rounded">
                                        <h5 class="mb-1 text-primary">{{ nucleotide }}</h5>
                                        <p class="mb-0 text-muted">{{ frequency }}%</p>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sequence Preview -->
    {% if sequence %}
    <div class="row justify-content-center mb-4">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-file-text"></i> Sequence Preview
                    </h5>
                </div>
                <div class="card-body">
                    <pre class="bg-light p-3 rounded font-monospace" style="max-height: 200px; overflow-y: auto;">{{ sequence }}</pre>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                <a href="/" class="btn btn-primary btn-lg">
                    <i class="bi bi-arrow-left"></i> New Prediction
                </a>
                <a href="/download-report" class="btn btn-success btn-lg">
                    <i class="bi bi-download"></i> Download Report
                </a>
                <a href="/history" class="btn btn-secondary btn-lg">
                    <i class="bi bi-clock-history"></i> View History
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
